<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>index</title>
<style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; max-width: 900px; margin: 40px auto; padding: 20px; color: #333; }
        h1, h2, h3, h4 { color: #1f77b4; margin-top: 1.5em; }
        table { border-collapse: collapse; width: 100%; margin: 1em 0; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #f2f2f2; font-weight: bold; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        code { background-color: #f4f4f4; padding: 2px 6px; border-radius: 3px; font-family: monospace; }
        pre { background-color: #f4f4f4; padding: 12px; border-radius: 5px; overflow-x: auto; }
        img { max-width: 100%; height: auto; margin: 20px 0; border-radius: 5px; }
        blockquote { border-left: 4px solid #1f77b4; margin: 1em 0; padding-left: 1em; color: #555; }
        a { color: #1f77b4; text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
<p></p>
<p></p>
<h2>1. Key Visualization: Distribution Sites Map</h2>
<p></p>
<p>Our spatial analysis of meal distribution across San Francisco reveals significant opportunities for reallocation. The map below plots all 40 distribution sites with embedded bar charts showing three allocation scenarios:</p>
<p></p>
<img src="outputs/figures/sf_distribution_sites_map.png" alt="" />
<p></p>
<p><strong>Map Interpretation:</strong></p>
<p>- Each site displays three bars showing meal counts:</p>
<p>- <strong>Blue</strong>: SFUSD planned meals (current)</p>
<p>- <strong>Orange</strong>: Optimal allocation based on Census ACS child population</p>
<p>- <strong>Green</strong>: Optimal allocation based on CDE FRPM-eligible students</p>
<p>- The OpenStreetMap basemap shows geographic context within San Francisco</p>
<p>- Sites with large orange and green bars indicate high-priority locations for meal concentration</p>
<p></p>
<p>This geographic visualization demonstrates that optimal reallocation would concentrate meals at 2-4 strategically located sites (particularly in the Mission, Richmond, and Tenderloin areas) while maintaining or reducing supply at other locations.</p>
<p></p>
<p>---</p>
<p></p>
<h2>2. Problem Statement</h2>
<p></p>
<p>During the SFUSD strike window (Monday, February 9, 2026 and Tuesday, February 10, 2026), community organizations distributed packed meals at fixed locations across San Francisco. The planning question is how to allocate limited meals across sites to better match tract-level child demand (<code>age < 18</code>) derived from the most recent Census ACS release and school-based demand from California Department of Education FRPM data.</p>
<p></p>
<p>This report compares:</p>
<p></p>
<p>- <code>status_quo</code>: site-day capacities as listed.</p>
<p>- <code>optimal_reallocation</code>: same day-total supply, reallocated across open sites using a linear program.</p>
<p>- <strong>Dual demand approaches</strong>: Census-based (ACS) child population vs. school-based (CDE) FRPM eligibility.</p>
<p></p>
<h2>3. Problem Formulation</h2>
<p></p>
<p>{{< include report<em>sections/problem</em>formulation_nested.qmd >}}</p>
<p></p>
<h2>4. Empirics</h2>
<p></p>
<p>{{< include report<em>sections/empirics</em>nested.qmd >}}</p>
<p></p>
<h2>5. Results</h2>
<p></p>
<h3>5.1 Scenario Summary</h3>
<p></p>
<table>
<tr>
<th>Scenario</th>
<th>Participation Rate</th>
<th>Served (Status Quo)</th>
<th>Served (Optimal)</th>
<th>Coverage (Status Quo)</th>
<th>Coverage (Optimal)</th>
<th>Avg Distance Miles (Status Quo)</th>
<th>Avg Distance Miles (Optimal)</th>
<th>Implied Meals Moved</th>
</tr>
<table>
<tr>
<th>`pr0p2`</th>
<th>0.2</th>
<th>3715.0</th>
<th>3715.0</th>
<th>0.081822</th>
<th>0.081822</th>
<th>0.157873</th>
<th>0.107547</th>
<th>1186.8</th>
</tr>
<table>
<tr>
<th>`pr0p3`</th>
<th>0.3</th>
<th>3715.0</th>
<th>3715.0</th>
<th>0.054548</th>
<th>0.054548</th>
<th>0.142258</th>
<th>0.094259</th>
<th>1365.0</th>
</tr>
<table>
<tr>
<th>`pr0p4`</th>
<th>0.4</th>
<th>3715.0</th>
<th>3715.0</th>
<th>0.040911</th>
<th>0.040911</th>
<th>0.139696</th>
<th>0.087510</th>
<th>1635.6</th>
</tr>
<p>Coverage remains fixed (total supply is fixed), while optimized reallocation lowers average distance and shifts a substantial number of meals across sites.</p>
<h3>5.2 Status Quo vs Optimal (Site-Day Scatter)</h3>
<img src="outputs/figures/status_quo_vs_optimal_allocations.png" alt="" />
<h3>5.3 Site-Level Facet Grid (8 x 5)</h3>
<p>Facet titles are <code>site name + address</code>. Each panel aggregates each site's <strong>two-day total lunches</strong> by participation rate and compares status quo vs optimal allocations.</p>
<img src="outputs/figures/site_allocation_facets_8x5.png" alt="" />
<h2>6. Work Log And Directory Structure</h2>
<h3>6.1 Distilled Work Log</h3>
<p>1. Ingested strike meal-site capacities from your SF.gov PDF export and built:</p>
<p>- <code>data/raw/meal<em>sites</em>manual.csv</code></p>
<p>- <code>data/processed/site<em>day</em>supply.csv</code></p>
<p>2. Pulled SF tract child population (<code>age < 18</code>) from Census ACS API and built:</p>
<p>- <code>data/processed/tract<em>child</em>population.csv</code></p>
<p>- <code>data/processed/tract<em>day</em>demand.csv</code></p>
<p>3. Built spatial model inputs:</p>
<p>- geocoded sites via Census geocoder to <code>data/processed/site_locations.csv</code></p>
<p>- tract centroids via GeoPandas/TIGER to <code>data/processed/tract_centroids.csv</code></p>
<p>- tract-site distance matrix to <code>data/processed/tract<em>site</em>cost_matrix.csv</code></p>
<p>4. Solved and compared allocation models:</p>
<p>- <code>data/processed/allocation<em>comparison</em>summary.csv</code></p>
<p>- <code>data/processed/site<em>day</em>allocation_comparison.csv</code></p>
<p>5. Produced reporting visuals:</p>
<p>- <code>outputs/figures/status<em>quo</em>vs<em>optimal</em>allocations.png</code></p>
<p>- <code>outputs/figures/site<em>allocation</em>facets_8x5.png</code></p>
<h3>6.2 Key Scripts</h3>
<p>- <code>scripts/extract<em>meal</em>sites<em>from</em>pdf.py</code></p>
<p>- <code>scripts/build<em>site</em>day_supply.py</code></p>
<p>- <code>scripts/fetch<em>census</em>children.py</code></p>
<p>- <code>scripts/build<em>tract</em>day_demand.py</code></p>
<p>- <code>scripts/geocode<em>supply</em>sites.py</code></p>
<p>- <code>scripts/build<em>tract</em>centroids.py</code></p>
<p>- <code>scripts/build<em>tract</em>site<em>cost</em>matrix.py</code></p>
<p>- <code>scripts/solve<em>allocation</em>lp.py</code></p>
<p>- <code>scripts/plot<em>site</em>facets.py</code></p>
<h3>6.3 Data Sources</h3>
<p>- SF meal-site listing (PDF export from SF.gov strike meals page)</p>
<p>- U.S. Census ACS 5-year API (<code>B01001</code> age bins)</p>
<p>- U.S. Census TIGER tract polygons (California, 2024)</p>
<p>- U.S. Census Geocoder API (<code>Public<em>AR</em>Current</code>)</p>
<h3>6.4 Directory Snapshot</h3>
<p>```text</p>
<p>data/</p>
<p>raw/</p>
<p>meal<em>sites</em>source.txt</p>
<p>meal<em>sites</em>manual.csv</p>
<p>processed/</p>
<p>site<em>day</em>supply.csv</p>
<p>site_locations.csv</p>
<p>tract<em>child</em>population.csv</p>
<p>tract<em>day</em>demand.csv</p>
<p>tract_centroids.csv</p>
<p>tract<em>site</em>cost_matrix.csv</p>
<p>allocation<em>comparison</em>summary.csv</p>
<p>site<em>day</em>allocation_comparison.csv</p>
<p>outputs/</p>
<p>figures/</p>
<p>status<em>quo</em>vs<em>optimal</em>allocations.png</p>
<p>site<em>allocation</em>facets_8x5.png</p>
<p>scripts/</p>
<p>extract<em>meal</em>sites<em>from</em>pdf.py</p>
<p>build<em>site</em>day_supply.py</p>
<p>fetch<em>census</em>children.py</p>
<p>build<em>tract</em>day_demand.py</p>
<p>geocode<em>supply</em>sites.py</p>
<p>build<em>tract</em>centroids.py</p>
<p>build<em>tract</em>site<em>cost</em>matrix.py</p>
<p>solve<em>allocation</em>lp.py</p>
<p>plot<em>site</em>facets.py</p>
<p>```</p>
</body>
</html>